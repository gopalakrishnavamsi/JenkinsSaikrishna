<template>
    <c-modal header={label.signingOrderDiagram}
             show-modal={showSigningOrderDiagram}
             onclose={handleClose}>
        <div slot="content">
            <div class="diagram-container">
                <table role="presentation">
                    <tr class="diagram-row">
                        <td>
                            <h4 class="diagram-row-caption text-uppercase">
                                {label.sender}
                            </h4>
                        </td>
                        <td class="diagram-row-contents text-center sender">
                            <div class="thumbnail-wrapper" style={signingOrderImage}>
                                <button class="thumbnail-contents senderText"
                                        type="button"
                                        role="text">
                                    <span>
                                        {label.sender}
                                    </span>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <template for:each={orderedRoutingGroups} for:item="routingGroup">
                        <tr class="diagram-row" key={routingGroup.routingOrder}>
                            <td>
                                <h4 class="diagram-row-caption">
                                    {routingGroup.routingOrder}
                                </h4>
                            </td>
                            <td class="diagram-row-contents text-center recipient-row">
                                <template for:each={routingGroup.recipients} for:item="recipient">
                                    <div class="thumbnail-wrapper" style={signingOrderImage} key={recipient.index}>
                                            <span>
                                                <button class="thumbnail-contents"
                                                        type="button"
                                                        role="text"
                                                        data-name={recipient.name}
                                                        data-email={recipient.email}
                                                        data-iconname={recipient.iconName}
                                                        data-customid={recipient.customId}
                                                        onmouseenter={handleRecipientToolTip}
                                                        onfocus={handleRecipientToolTip}
                                                        onblur={hideRecipientToolTip}
                                                        onmouseleave={hideRecipientToolTip}
                                                        aria-describedby={recipient.name}>
                                                    {recipient.initials}
                                                </button>
                                                <div class="slds-is-absolute"
                                                     data-customid={recipient.customId} style="display:none">
                                                    <section class="slds-popover slds-nubbin_top-left tooltipContent slds-text-align_left"
                                                             role="dialog">
                                                        <div class="slds-popover__body popover">
                                                            <template for:each={toolTipLabel} for:item="label">
                                                                <div key={label.name}>
                                                                    <span class="tooltipLabel slds-p-left_xx-small">{label.name}</span>
                                                                    <template if:true={label.email}>
                                                                        <p class="toolTipEmail"> {label.email} </p>
                                                                    </template>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </section>
                                                 </div>
                                            </span>
                                    </div>
                                </template>
                                <template if:true={routingGroup.hasAdditionalRecipients}>
                                    <div class="thumbnail-wrapper" style={signingOrderImage}>
                                        <span>
                                            <!-- Todo - mouse events - optimize mouse enter and leave -->
                                            <button class="thumbnail-contents"
                                                    type="button"
                                                    role="text"
                                                    data-group={routingGroup.routingOrder}
                                                    data-groupstring={routingGroup.routingOrderString}
                                                    onmouseenter={handleAdditionalRecipientToolTip}
                                                    onmouseleave={hideAdditionalRecipientToolTip}>
                                                + {routingGroup.numberOfAdditionalRecipients}
                                            </button>
                                            <div class="slds-is-absolute"
                                                 data-customgroupid={routingGroup.routingOrderString}
                                                 style="display:none">
                                                <section class="slds-popover slds-nubbin_top-left tooltipContent slds-text-align_left"
                                                         role="dialog">
                                                    <div class="slds-popover__body popover">
                                                        <template for:each={toolTipLabel} for:item="label">
                                                             <div key={label.name}>
                                                                 <span class="tooltipLabel slds-p-left_xx-small">{label.name}</span>
                                                                 <template if:true={label.email}>
                                                                    <p class="toolTipEmail"> {label.email} </p>
                                                                 </template>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </section>
                                            </div>
                                        </span>
                                    </div>
                                </template>
                            </td>
                        </tr>
                    </template>
                    <tr class="diagram-row">
                        <td>
                            <h4 class="diagram-row-caption text-uppercase">
                                {label.completed}
                            </h4>
                        </td>
                        <td class="diagram-row-contents text-center completed">
                            <div class="thumbnail-wrapper" style={signingOrderImage}>
                                <button class="thumbnail-contents"
                                        type="button"
                                        role="text">
                                       <lightning-icon
                                               icon-name="utility:check"
                                               size="xx-small"
                                               class="completedCheck"></lightning-icon>
                                </button>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div slot="footer">
        </div>
    </c-modal>
</template>