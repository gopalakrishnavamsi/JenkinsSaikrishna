<template>
    <div class="ds-envelopeConfig-setup"
         onupdate={updateLocalData}>
        <lightning-spinner if:true={isLoading}
                           alternative-text="Loading"
                           size="medium"
                           variant="brand">
        </lightning-spinner>
        <c-dec-header
                icon="standard:email_chatter"
                header-name={label.envelopeConfiguration}
                sub-header-name={configurationName}
                modal-title={label.renameEnvelopeConfiguration}
                disable-all-buttons={isEmptyRecipients}
                is-first-step={documentsStep}
                is-final-step={customButtonStep}
                onsaveandclose={handleSaveAndClose}
                onnext={handleNext}
                onback={handleBack}>
        </c-dec-header>
        <div class="slds-m-top_large slds-m-bottom_xx-large ds-envelopeConfig-margin">
            <c-progress-bar
                    current-step={currentStep}
                    steps={steps}
                    onclickprogressstep={handleOnClickProgressStep}
                    disable-steps={isEmptyRecipients}>
            </c-progress-bar>
            <c-dec-documents
                    onupdatetemplatedocuments={handleUpdateDocument}
                    if:true={documentsStep}
                    documents={documents}
                    attach-source-files={attachSourceFiles}
                    record-id={recordId}>
            </c-dec-documents>
            <c-recipients-config if:true={recipientsStep}
                                 source-object={sourceObject}
                                 recipients={recipients}
                                 onemptyrecipients={handleEmptyRecipient}>
            </c-recipients-config>
            <c-dec-recipient-message
                    if:true={showEmailMessage}
                    email-subject={emailSubject}
                    email-message={emailMessage}
                    onemailchange={handleEmailChange}>
            </c-dec-recipient-message>
            <!-- merge fields step to be returned in eSign Phase 2 -->
            <!-- <c-dec-merge-fields if:true={mergeFieldsStep}>
            </c-dec-merge-fields> -->
            <!-- tagger step -->
            <c-dec-tagger if:true={taggerStep}
                          record-id={recordId}>

            </c-dec-tagger>
            <!-- options step -->
            <c-dec-options
                    if:true={optionsStep}
                    notifications={notifications}
                    options={options}
                    record-id={recordId}
                    source-object={sourceObject}
                    ondocumentwriteback={handleOnDocumentWriteBack}
                    ondatawriteback={handleOnDataWriteBack}>
            </c-dec-options>
            <!-- custom buttons step -->
            <template if:true={customButtonStep}>
                <c-dec-custom-button
                        record-id={recordId}
                        source-object={sourceObject}></c-dec-custom-button>
            </template>
        </div>
    </div>
</template>
