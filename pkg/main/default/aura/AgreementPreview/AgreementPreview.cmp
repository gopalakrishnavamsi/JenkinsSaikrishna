<aura:component implements="force:appHostable" controller="AgreementsController">
    <!-- start of attributes passed from Lightning out VF page -->
    <aura:attribute name="sourceId" type="Id" access="public"/>
    <aura:attribute name="agreementId" type="Id" access="public"/>
    <aura:attribute name="currentUserEmail" type="String" access="public"/>
    <aura:attribute name="currentUserDocuSignAdmin" type="Boolean" access="public"/>

    <!-- end of attributes passed from Lightning out VF page -->

    <aura:attribute name="agreementActionManager" type="Object"/>
    <aura:attribute name="agreement" type="Agreement"/>
    <aura:attribute name="uiHelper" type="Object"/>
    <aura:attribute name="loading" type="Boolean" default="true"/>
    <aura:attribute name="message" type="String"/>
    <aura:attribute name="mode" type="String"/>
    <aura:attribute name="showToast" type="Boolean" default="false"/>

    <ltng:require styles="{!$Resource.scmwidgetscss}"
                  scripts="{!join(',',$Resource.AgreementActionManager, $Resource.scmwidgetsjs, $Resource.uiHelper)}"
                  afterScriptsLoaded="{!c.onLoad}"/>

    <aura:registerEvent name="toastEvent" type="c:ToastEvent"/>
    <aura:registerEvent name="loadingEvent" type="c:LoadingEvent"/>
    <aura:handler name="toastEvent" event="c:ToastEvent" action="{!c.handleToastEvent}"/>
    <aura:handler name="loadingEvent" event="c:LoadingEvent" action="{!c.handleLoadingEvent}"/>
    <div class="slds-scope">
        <div class="fullContainer">
            <div class="toolbarContainer">
                <c:AgreementPreviewToolBar agreement="{!v.agreement}" sourceId="{!v.sourceId}"
                                           agreementActionManager="{!v.agreementActionManager}"
                                           uiHelper="{!v.uiHelper}"/>
            </div>
            <div class="documentContainer">
                <c:AgreementPreviewDocument agreement="{!v.agreement}" sourceId="{!v.sourceId}" uiHelper="{!v.uiHelper}"
                                            currentUserEmail="{!v.currentUserEmail}"
                                            currentUserDocuSignAdmin="{!v.currentUserDocuSignAdmin}"/>
                <aura:if isTrue="{!v.loading}">
                    <div class="slds-is-relative loadingContainer">
                        <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                            <span class="slds-assistive-text">{!$Label.c.Loading}</span>
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </aura:if>
            </div>
        </div>
    </div>
    <c:Toast aura:id="toast" message="{!v.message}" mode="{!v.mode}" showToast="{!v.showToast}" visualforce="true"/>
</aura:component>